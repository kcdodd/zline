import numpy as np
import matplotlib.pyplot as plt

#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# Predefined colormaps
VIRIDIS = np.array(
  [ [0x12, 0x12, 0x12],
    [0x26, 0x26, 0x26],
    [0x3a, 0x3a, 0x3a],
    [0x5f, 0x00, 0x5f],
    [0x5f, 0x00, 0xaf],
    [0x5f, 0x00, 0xff],
    [0x00, 0x5f, 0xaf],
    [0x00, 0x5f, 0x87],
    [0x00, 0x87, 0x87],
    [0x00, 0xaf, 0x87],
    [0x87, 0xd7, 0x00],
    [0xaf, 0xff, 0x00],
    [0xff, 0xff, 0x5f],
    [0xff, 0xff, 0xff] ],
  dtype = np.uint32 )

#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
HOT = np.array(
  [ [0x12, 0x12, 0x12],
    [0x5f, 0x00, 0x00],
    [0x87, 0x00, 0x00],
    [0xaf, 0x00, 0x00],
    [0xd7, 0x00, 0x00],
    [0xff, 0x00, 0x00],
    [0xff, 0x5f, 0x00],
    [0xff, 0x87, 0x00],
    [0xff, 0xaf, 0x00],
    [0xff, 0xd7, 0x00],
    [0xff, 0xff, 0x00],
    [0xff, 0xff, 0xff] ],
  dtype = np.uint32 )

#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
RAINBOW = np.array(
  [ [0xff, 0x00, 0x00],
    [0xff, 0x5f, 0x00],
    [0xff, 0x87, 0x00],
    [0xff, 0xaf, 0x00],
    [0xff, 0xd7, 0x00],
    [0xff, 0xff, 0x00],
    [0xd7, 0xff, 0x00],
    [0xaf, 0xff, 0x00],
    [0x87, 0xff, 0x00],
    [0x5f, 0xff, 0x00],
    [0x00, 0xff, 0x00],
    [0x00, 0xff, 0x5f],
    [0x00, 0xff, 0x87],
    [0x00, 0xff, 0xaf],
    [0x00, 0xff, 0xd7],
    [0x00, 0xff, 0xff],
    [0x00, 0xd7, 0xff],
    [0x00, 0xaf, 0xff],
    [0x00, 0x87, 0xff],
    [0x00, 0x5f, 0xff],
    [0x00, 0x00, 0xff],
    [0x5f, 0x00, 0xff],
    [0x87, 0x00, 0xff],
    [0xaf, 0x00, 0xff],
    [0xd7, 0x00, 0xff],
    [0xff, 0x00, 0xff],
    [0xff, 0x00, 0xd7],
    [0xff, 0x00, 0xaf],
    [0xff, 0x00, 0x87],
    [0xff, 0x00, 0x5f] ],
  dtype = np.uint32 )

#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
DOPPLER = np.array(
  [ [0xff, 0xff, 0x00],
    [0xff, 0xd7, 0x00],
    [0xff, 0xaf, 0x00],
    [0xff, 0x87, 0x00],
    [0xff, 0x5f, 0x00],
    [0xff, 0x00, 0x00],
    [0xd7, 0x00, 0x00],
    [0xaf, 0x00, 0x00],
    [0x87, 0x00, 0x00],
    [0x5f, 0x00, 0x00],
    [0x12, 0x12, 0x12],
    [0x00, 0x00, 0x5f],
    [0x00, 0x00, 0x87],
    [0x00, 0x00, 0xaf],
    [0x00, 0x00, 0xd7],
    [0x00, 0x00, 0xff],
    [0x00, 0x5f, 0xff],
    [0x00, 0x87, 0xff],
    [0x00, 0xaf, 0xff],
    [0x00, 0xd7, 0xff],
    [0x00, 0xff, 0xff]],
  dtype = np.uint32 )

#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
GRAY = np.array(
  [ [0x08, 0x08, 0x08],
    [0x12, 0x12, 0x12],
    [0x1c, 0x1c, 0x1c],
    [0x26, 0x26, 0x26],
    [0x30, 0x30, 0x30],
    [0x3a, 0x3a, 0x3a],
    [0x44, 0x44, 0x44],
    [0x4e, 0x4e, 0x4e],
    [0x58, 0x58, 0x58],
    [0x62, 0x62, 0x62],
    [0x6c, 0x6c, 0x6c],
    [0x76, 0x76, 0x76],
    [0x80, 0x80, 0x80],
    [0x8a, 0x8a, 0x8a],
    [0x94, 0x94, 0x94],
    [0x9e, 0x9e, 0x9e],
    [0xa8, 0xa8, 0xa8],
    [0xb2, 0xb2, 0xb2],
    [0xbc, 0xbc, 0xbc],
    [0xc6, 0xc6, 0xc6],
    [0xd0, 0xd0, 0xd0],
    [0xda, 0xda, 0xda],
    [0xe4, 0xe4, 0xe4],
    [0xee, 0xee, 0xee] ],
  dtype = np.uint32 )

#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
CMAPS = {
  'viridis8': VIRIDIS,
  'hot8': HOT,
  'rainbow8': RAINBOW,
  'doppler8': DOPPLER,
  'gray8': GRAY }

#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
def get_cmap(name):

  if name in CMAPS:
    cmap = CMAPS[name]
    nc = len(cmap)

    def _cmap(val):
      i = np.clip(nc*val, 0, nc).astype(np.uint8)
      return cmap[i]

    return _cmap

  cmap = plt.get_cmap(name)

  def _cmap_plt(val):
    return np.clip(255*cmap(val)[:,:,:3], 0, 255).astype(np.uint8)

  return _cmap_plt
